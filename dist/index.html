<!doctypehtml><meta charset="utf-8"><title>VR Drone Racing - Cenário Limpo</title><meta name="description"content="Corrida de Drone VR - Cenário Limpo Otimizado para Oculus"><meta http-equiv="Cache-Control"content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma"content="no-cache"><meta http-equiv="Expires"content="0"><script src="libs/aframe.min.js"></script><script src="libs/aframe-extras.min.js"></script><script src="libs/aframe-environment-component.min.js"></script><script>console.log("🔧 Registrando componente sky-360-loader..."),AFRAME.registerComponent("sky-360-loader",{schema:{src:{type:"string",default:"assets/textures/bg-1.jpeg"}},init:function(){console.log("🌆 Sky 360 Loader INICIADO"),console.log("📂 Caminho:",this.data.src),this.loadSkyTexture()},loadSkyTexture:function(){const t=new THREE.TextureLoader,e=this.el;console.log("📥 Carregando textura:",this.data.src),setTimeout(()=>{t.load(this.data.src,t=>{console.log("✅ SUCESSO! Textura carregada:",{width:t.image.width,height:t.image.height});const o=e.getObject3D("mesh");o&&o.material?(console.log("🔧 Material antes:",o.material),o.material.map=t,o.material.needsUpdate=!0,o.material.side=THREE.BackSide,o.material.transparent=!1,o.material.opacity=1,console.log("🔧 Material depois:",o.material),console.log("✅ Sky 360 APLICADO!")):console.error("❌ Mesh ou material não encontrado!")},t=>{const e=(t.loaded/t.total*100).toFixed(0);console.log(`📊 Progresso: ${e}%`)},t=>{console.error("❌ ERRO ao carregar:",t),console.error("❌ Caminho:",this.data.src)})},1e3)}}),console.log("✅ Componente sky-360-loader registrado!"),AFRAME.registerComponent("sky-parallax",{schema:{intensity:{type:"number",default:.05}},init:function(){console.log("🌊 Parallax do Sky ativado"),this.drone=null,this.initialRotation={x:0,y:0,z:0}},tick:function(){if(!this.drone&&(this.drone=document.querySelector("#drone"),!this.drone))return;const t=this.drone.object3D.position,e=t.x*this.data.intensity,o=-t.z*this.data.intensity*.5;this.el.setAttribute("rotation",{x:this.initialRotation.x+o,y:this.initialRotation.y+e,z:this.initialRotation.z})}}),console.log("✅ Componente sky-parallax registrado!")</script><link rel="stylesheet"type="text/css"href="css/style.min.css"><body><script src="js/app.min.js"></script><script src="js/hud-controller.js?v=1.0.0"></script><a-scene vr-mode-ui="enabled: true"webxr="requiredFeatures: local-floor; optionalFeatures: bounded-floor"renderer="antialias: false; colorManagement: false; sortObjects: false; physicallyCorrectLights: false; gammaFactor: 2.2; highRefreshRate: true; foveationLevel: 0"game-manager="totalCheckpoints: 3; timeLimit: 180"urban-environment="citySize: 30; buildingCount: 0; obstacleCount: 0; treeCount: 0; vrOptimized: true; ultraLowPoly: true"performance-monitor="targetFPS: 90; minFPS: 72; autoOptimize: true; showStats: false; aggressiveOptimization: true"audio-system="masterVolume: 0.4; musicVolume: 0.1; sfxVolume: 0.5; ambientVolume: 0.05; enableAudio: true"collision-system="enabled: true; bounceForce: 0.5; showEffects: false; soundEnabled: false"hud-controls vr-performance-optimizer ground-diagnostics sky-diagnostics><a-assets><a-mixin id="checkpoint"geometry="primitive: torus; radius: 3; radiusTubular: 0.3"material="color: #00ff00; transparent: true; opacity: 0.6; metalness: 0; roughness: 1; emissive: #00ff00; emissiveIntensity: 0.4"animation="property: rotation; to: 0 360 0; loop: true; dur: 8000"></a-mixin><img id="hud-overlay-limpo"src="assets/hud-01.svg"crossorigin="anonymous"> <img id="skyTexture"src="assets/textures/bg-1.jpeg"> <img id="ground-texture"src="assets/textures/chao.jpg"crossorigin="anonymous"></a-assets><a-sky id="main-sky"src="assets/textures/upscalemedia-transformed.jpeg"rotation=""radius="10000"sky-parallax="intensity: 0.08"material=""geometry=""></a-sky><a-light type="ambient"color="#ffffff"intensity="0.8"></a-light><a-light type="directional"position="50 80 30"color="#ffffee"intensity="1.0"castshadow="false"></a-light><a-light type="hemisphere"color="#ffffff"groundcolor="#8A7050"intensity="0.5"></a-light><a-entity id="drone"position="0 0 0"drone-controller navigation-arrow physics-body="type: dynamic; mass: 2; linearDamping: 0.1; angularDamping: 0.1"><a-entity id="drone-body"geometry="primitive: box; width: 0.8; height: 0.2; depth: 0.8"material="color: #00aa00; metalness: 0; roughness: 1; emissive: #001100; emissiveIntensity: 0.3"><a-entity geometry="primitive: sphere; radius: 0.02"material="color: #00ff00; emissive: #00ff00; emissiveIntensity: 0.8"position="0 0.12 0"></a-entity></a-entity><a-entity id="prop1"geometry="primitive: cylinder; radius: 0.25; height: 0.01"material="color: #ff4444; transparent: true; opacity: 0.2"position="0.6 0.15 0.6"animation="property: rotation; to: 0 1800 0; loop: true; dur: 600"></a-entity><a-entity id="prop2"geometry="primitive: cylinder; radius: 0.25; height: 0.01"material="color: #ff4444; transparent: true; opacity: 0.2"position="-0.6 0.15 0.6"animation="property: rotation; to: 0 -1800 0; loop: true; dur: 600"></a-entity><a-entity id="prop3"geometry="primitive: cylinder; radius: 0.25; height: 0.01"material="color: #ff4444; transparent: true; opacity: 0.2"position="0.6 0.15 -0.6"animation="property: rotation; to: 0 -1800 0; loop: true; dur: 600"></a-entity><a-entity id="prop4"geometry="primitive: cylinder; radius: 0.25; height: 0.01"material="color: #ff4444; transparent: true; opacity: 0.2"position="-0.6 0.15 -0.6"animation="property: rotation; to: 0 1800 0; loop: true; dur: 600"></a-entity><a-camera id="drone-camera"position="0 -0.30 -0.5"rotation="-15 0 0"wasd-controls="enabled: false"look-controls="enabled: true; pointerLockEnabled: false"vr-camera-sync camera="far: 20000; near: 0.1"hud-controller="enabled: true; transparency: 1.0; hudWidth: 3.5; hudHeight: 2.5; hudDistance: 2.0; parallaxIntensity: 0.03; smoothingFactor: 0.1"></a-camera></a-entity><a-entity mixin="checkpoint"position="15 8 -15"checkpoint="id: 1"></a-entity><a-entity mixin="checkpoint"position="-20 12 -30"checkpoint="id: 2"></a-entity><a-entity mixin="checkpoint"position="0 10 -45"checkpoint="id: 3"></a-entity><a-gltf-model src="assets/npc/AbbyRoupaClara.glb"position="-1.806 -0.02341 -3.5"gltf-model="assets/npc/AbbyRoupaClara.glb"></a-gltf-model><a-light type="point"position="-1.806 1.5 -2.5"color="#ffffff"intensity="2.0"distance="5"></a-light><a-gltf-model src="#quadra"position="-0.997 -2.20319 -0.264"gltf-model="assets/Quadra.glb"scale="0.8 0.8 0.8"></a-gltf-model><a-plane id="ground-main"position="0 -1 0"rotation="-90 0 0"width="20000"height="20000"material="src: #ground-texture; color: #846338; repeat: 200 200; metalness: 0; roughness: 1; side: double; depthWrite: true; depthTest: true"shadow="receive: false"visible="true"></a-plane><a-entity id="sky-boundary"boundary-limiter="radius: 9900"></a-entity><a-entity id="leftHand"oculus-touch-controls="hand: left; model: false"quest-controls="hand: left"position="-0.5 1 -0.5"></a-entity><a-entity id="rightHand"oculus-touch-controls="hand: right; model: false"quest-controls="hand: right"position="0.5 1 -0.5"></a-entity><a-entity geometry="primitive: box; width: 15; height: 0.3; depth: 1.5"material="color: #ff0000; transparent: true; opacity: 0.6"position="0 1 -50"finish-line></a-entity></a-scene><div id="loading"><h2>Carregando Cenário Limpo VR...</h2><div class="progress-bar"><div class="progress"></div></div></div><div id="hud-help"style="position:fixed;top:10px;right:10px;background:rgba(0,0,0,.8);color:#fff;padding:15px;border-radius:8px;font-family:'Courier New',monospace;font-size:12px;z-index:1000;border:1px solid #fff;max-width:320px"><div style="font-weight:700;margin-bottom:10px;color:#fff">🎯 HUD CONTROLLER CENTRALIZADO</div><div style="margin-bottom:5px"><strong>H</strong> - Alternar HUD</div><div style="margin-bottom:5px"><strong>U</strong> - Ajustar Transparência</div><div style="margin-bottom:5px"><strong>K</strong> - Recarregar HUD</div><div style="color:#fa0;font-weight:700;margin:8px 0 5px 0">📏 Dimensões:</div><div style="margin-bottom:5px"><strong>+/-</strong> - Aumentar/Diminuir HUD</div><div style="margin-bottom:5px"><strong>0</strong> - Reset completo</div><div style="color:#fa0;font-weight:700;margin:8px 0 5px 0">📊 Dados Exibidos:</div><div style="margin-bottom:3px">• Velocidade (KM/H)</div><div style="margin-bottom:3px">• Altitude (Metros)</div><div style="margin-bottom:3px">• Bateria (% com cor dinâmica)</div><div style="margin-bottom:3px">• Coordenadas GPS</div><div style="margin-bottom:3px">• Distância para Objetivo</div><div style="margin-bottom:3px">• Modo de Voo</div><div style="margin-bottom:3px">• Tempo de Missão</div><div style="margin-top:10px;padding-top:8px;border-top:1px solid #fff;font-size:10px;opacity:.8">🎯 HUD totalmente transparente (sem fundo)<br>📏 Sistema centralizado para fácil manutenção<br>📍 Paralaxe sutil baseado no movimento do drone<br>🛸 Apenas linhas brancas do hud-01.svg visíveis</div></div><script>AFRAME.registerComponent("boundary-limiter",{schema:{radius:{type:"number",default:9900}},init:function(){console.log("🚧 Limitador de Fronteira ativado - Raio:",this.data.radius),this.drone=null},tick:function(){if(!this.drone&&(this.drone=document.querySelector("#drone"),!this.drone))return;const e=this.drone.object3D.position;if(Math.sqrt(e.x*e.x+e.z*e.z)>this.data.radius){const o=Math.atan2(e.z,e.x);e.x=Math.cos(o)*this.data.radius,e.z=Math.sin(o)*this.data.radius,console.log("⚠️ Drone atingiu o limite! Reposicionando...")}}}),AFRAME.registerComponent("ground-diagnostics",{init:function(){console.log("🔍 Diagnóstico do Solo Iniciado"),setTimeout(()=>{const e=document.querySelector("#ground-main");if(e){const o=e.getAttribute("material"),t=e.getAttribute("position"),i=e.getAttribute("visible"),n=e.getAttribute("geometry");console.log("📊 Estado do Solo:",{visible:i,position:t,material:o,geometry:n,object3D:e.object3D?"OK":"ERRO"}),e.object3D&&(e.object3D.visible=!0,e.object3D.renderOrder=-1,console.log("✅ Solo forçado a renderizar")),setInterval(()=>{e.object3D&&!e.object3D.visible&&(console.warn("⚠️ Solo ficou invisível! Reativando..."),e.object3D.visible=!0)},1e3)}else console.error("❌ Solo não encontrado!")},2e3)}}),AFRAME.registerComponent("vr-performance-optimizer",{init:function(){console.log("🚀 Otimizador VR ativado");const e=this.el.renderer;e&&(e.setPixelRatio(Math.min(window.devicePixelRatio,1.5)),e.shadowMap.enabled=!1,e.shadowMap.autoUpdate=!1,e.powerPreference="high-performance",e.antialias=!1,e.stencil=!1,e.depth=!0,e.logarithmicDepthBuffer=!1),this.optimizeForQuest(),this.startPerformanceMonitoring()},optimizeForQuest:function(){if(navigator.userAgent.includes("Quest")||navigator.userAgent.includes("Oculus")){console.log("🥽 Quest detectado - aplicando otimizações específicas");const e=this.el;e.setAttribute("renderer",{antialias:!1,colorManagement:!1,sortObjects:!1,physicallyCorrectLights:!1,gammaFactor:2.2,highRefreshRate:!0,foveationLevel:0,multiview:!0}),e.setAttribute("fog",{type:"linear",color:"#87CEEB",near:500,far:1e3})}},startPerformanceMonitoring:function(){let e=0,o=performance.now(),t=0;const i=()=>{e++;const n=performance.now();if(n-o>=1e3){Math.round(1e3*e/(n-o))<60?(t++,t>=3&&(this.applyEmergencyOptimizations(),t=0)):t=0,e=0,o=n}requestAnimationFrame(i)};i()},applyEmergencyOptimizations:function(){console.log("⚡ Aplicando otimizações emergenciais"),console.log("⚡ Cenário limpo - sem elementos adicionais para otimizar");document.querySelectorAll('[id^="prop"]').forEach(e=>{const o=e.getAttribute("animation");o&&e.setAttribute("animation",{...o,dur:1e3})}),this.el.setAttribute("fog",{type:"linear",color:"#87CEEB",near:500,far:1e3})}}),AFRAME.registerComponent("vr-camera-sync",{init:function(){console.log("🥽 Sincronização VR ativada"),this.browserState={position:this.el.getAttribute("position"),rotation:this.el.getAttribute("rotation")},this.vrCameraPosition={x:0,y:-2,z:-.5},this.vrCameraRotation={x:10,y:0,z:0},this.el.sceneEl.addEventListener("enter-vr",()=>{console.log("📱 Entrando no VR - Posicionando câmera embaixo do drone..."),this.positionCameraForVR()}),this.positionCameraForVR=()=>{for(let e=0;e<5;e++)setTimeout(()=>{this.el.setAttribute("position",this.vrCameraPosition),this.el.setAttribute("rotation",this.vrCameraRotation),console.log(`✅ Tentativa ${e+1}: Câmera VR posicionada embaixo do drone`)},100*(e+1))},this.el.sceneEl.addEventListener("exit-vr",()=>{console.log("🖥️ Saindo do VR - Restaurando posição original..."),setTimeout(()=>{this.el.setAttribute("position",this.browserState.position),this.el.setAttribute("rotation",this.browserState.rotation)},100)}),setInterval(()=>{if(this.el.sceneEl.is("vr-mode")){this.el.getAttribute("position").y>-1.5&&(this.el.setAttribute("position",this.vrCameraPosition),this.el.setAttribute("rotation",this.vrCameraRotation),console.log("🔄 Forçando câmera para baixo do drone"))}else this.browserState.position=this.el.getAttribute("position"),this.browserState.rotation=this.el.getAttribute("rotation")},200)}}),document.addEventListener("DOMContentLoaded",function(){console.log("🎮 Inicializando o jogo...");document.querySelector("a-scene").addEventListener("loaded",function(){setTimeout(function(){const e=document.querySelector("#drone");e&&e.components["drone-controller"]?(e.components["drone-controller"].activateDrone(),console.log("✅ Drone ativado com sucesso!")):console.error("❌ Erro ao ativar o drone!");const o=document.querySelector("[game-manager]");o&&o.components["game-manager"]?(o.components["game-manager"].startGame(),console.log("✅ Jogo iniciado com sucesso!")):console.error("❌ Erro ao iniciar o jogo!");const t=document.getElementById("loading");t&&(t.style.display="none"),console.log("✅ Jogo inicializado com sucesso!");const i=document.querySelector("#main-sky");console.log("🌆 Sky 360 bg-6 carregado:",i?.getAttribute("src")),setTimeout(()=>{const e=document.querySelector("#drone-camera"),o=e?.components?.["hud-controller"];o?(console.log("🎯 HUD Controller carregado com sucesso!"),console.log("📊 Configurações do HUD:",{width:o.data.hudWidth,height:o.data.hudHeight,transparency:o.data.transparency,distance:o.data.hudDistance})):console.warn("⚠️ HUD Controller não foi carregado!")},1e3),setTimeout(()=>{const e=document.getElementById("hud-help");e&&(e.style.opacity="0.3",e.style.transition="opacity 1s ease-out")},8e3),setTimeout(()=>{const e=document.getElementById("hud-help");e&&(e.style.display="none")},15e3)},2e3)})})</script>